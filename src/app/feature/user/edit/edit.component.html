<div class="max-w-4xl mx-auto transition-colors duration-300">
  <div class="mb-8 flex items-center justify-between">
    <div>
      <h1 class="text-2xl font-black text-text-primary tracking-tight">Editar Usuario</h1>
      <p class="text-text-muted mt-1 font-medium">Actualiza la información del usuario existente.</p>
    </div>
    <a [routerLink]="ROUTES.nav.users.list"
      class="text-text-muted hover:text-text-primary transition-colors flex items-center gap-1 font-bold text-sm">
      <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" />
      </svg>
      Volver a la lista
    </a>
  </div>

  @if (loadingData()) {
  <div class="flex justify-center py-20 bg-bg-secondary rounded-3xl border border-border shadow-inner">
    <div class="w-10 h-10 border-4 border-bg-primary border-t-primary rounded-full animate-spin"></div>
  </div>
  } @else {
  <form (ngSubmit)="onSubmit()"
    class="bg-bg-secondary p-8 rounded-[32px] border border-border shadow-sm space-y-8 transition-colors duration-300">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">

      <app-input name="fullName" label="Nombre Completo" [(ngModel)]="user()!.profile.fullName" [required]="true"
        [maxlength]="100" [minLength]="3" [showErrors]="formSubmitted()"></app-input>

      <app-input name="phone" [placeholder]="'00000000'" label="Teléfono" [(ngModel)]="user()!.profile.phone"
        [required]="true" [maxlength]="15" [minLength]="8" [showErrors]="formSubmitted()"></app-input>

      <app-input name="username" label="Usuario" type="text" [(ngModel)]="user()!.profile.username"
        [placeholder]="'user_name'" [required]="true" [showErrors]="formSubmitted()"></app-input>

      <app-input name="email" label="Correo Electrónico" type="email" [(ngModel)]="user()!.profile.email"
        [placeholder]="'jhon@example.com'" [required]="true" [showErrors]="formSubmitted()"></app-input>

      <app-input name="birthDate" label="Fecha de nacimiento" type="date" [(ngModel)]="user()!.profile.birthDate"
        [placeholder]="'12/12/2020'" [required]="true" [showErrors]="formSubmitted()"></app-input>

      <app-input name="address" label="Dirección" [(ngModel)]="user()!.profile.address" [required]="true"
        [showErrors]="formSubmitted()"></app-input>

      @if(user()!.employee){
      <app-custom-select [label]="'Almacen'" [selected]="user()!.employee!.warehouseId" [options]="optionsWarehouses()"
        (onSelectionChange)="selectWarehouse($event)"></app-custom-select>

      <app-custom-select [label]="'Posición'" [selected]="user()!.employee!.positionId"
        [options]="optionsPositionTypes()" (onSelectionChange)="selectPositionType($event)"></app-custom-select>
      }

      <div class="md:col-span-2">
        <app-multi-select-roles [options]="roleOptions()" [(selectedRoles)]="userRoles" label="Roles del Sistema">
        </app-multi-select-roles>
      </div>
    </div>

    <app-button type="submit" [label]="submitting() ? 'Guardando...' : 'Actualizar Usuario'" [isLoading]="submitting()"
      icon="add-plus">
    </app-button>
  </form>
  }
</div>