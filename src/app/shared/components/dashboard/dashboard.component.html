<div class="dashboard-container fade-in">
  <h1>Resumen General</h1>

  @if (isLoading()) {
  <div class="loading-skeleton">Cargando datos del negocio...</div>
  } @else if (dashboardData(); as data) {

  <div class="kpi-grid">
    <div class="kpi-card blue">
      <div class="icon"><i class="fas fa-dollar-sign"></i></div>
      <div class="info">
        <h3>Ventas Hoy</h3>
        <p>{{ data.kpis.totalSalesToday | currency }}</p>
      </div>
    </div>
    <div class="kpi-card green">
      <div class="icon"><i class="fas fa-users"></i></div>
      <div class="info">
        <h3>Nuevos Clientes (Mes)</h3>
        <p>{{ data.kpis.newClientsThisMonth }}</p>
      </div>
    </div>
    <div class="kpi-card orange">
      <div class="icon"><i class="fas fa-shopping-bag"></i></div>
      <div class="info">
        <h3>Órdenes Pendientes</h3>
        <p>{{ data.kpis.pendingOrders }}</p>
      </div>
    </div>
    <div class="kpi-card red">
      <div class="icon"><i class="fas fa-exclamation-triangle"></i></div>
      <div class="info">
        <h3>Stock Bajo</h3>
        <p>{{ data.kpis.lowStockProducts }} productos</p>
      </div>
    </div>
  </div>

  <div class="middle-grid">
    <div class="chart-container card-panel">
      <h2>Tendencia de Ventas (Últimos 7 días)</h2>
      <div class="chart-wrapper">
        <canvas
          baseChart
          [type]="'line'"
          [data]="{
            labels: data.salesChartLabels,
            datasets: [
              {
                data: data.salesChartData,
                label: 'Ventas ($)',
                backgroundColor: 'rgba(14, 165, 233, 0.2)',
                borderColor: 'rgba(14, 165, 233, 1)',
                fill: true,
                tension: 0.4
              }
            ]
          }"
          [options]="lineChartOptions"
          [legend]="lineChartLegend"
        >
        </canvas>
      </div>
    </div>

    <div class="quick-actions card-panel">
      <h2>Accesos Rápidos</h2>
      <div class="action-buttons">
        <button class="btn-primary">Nuevo Producto <i class="fas fa-plus"></i></button>
        <button class="btn-secondary">Registrar Cliente <i class="fas fa-user-plus"></i></button>
        <button class="btn-action secondary">Ver Reportes <i class="fas fa-file-alt"></i></button>
      </div>
    </div>
  </div>

  <div class="bottom-grid card-panel">
    <h2>Órdenes Recientes</h2>
    <div class="table-responsive">
      <table class="data-table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Cliente</th>
            <th>Fecha</th>
            <th>Estado</th>
            <th>Total</th>
            <th>Acciones</th>
          </tr>
        </thead>
        <tbody>
          @for (order of data.recentOrders; track order.id) {
          <tr>
            <td>#{{ order.id }}</td>
            <td>{{ order.clientName }}</td>
            <td>{{ order.date }}</td>
            <td>
              <span class="badge" [ngClass]="getStatusClass(order.status)">
                {{ order.status }}
              </span>
            </td>
            <td>
              <strong>{{ order.total | currency }}</strong>
            </td>
            <td>
              <button class="btn-sm">Ver <i class="fas fa-eye"></i></button>
            </td>
          </tr>
          }
        </tbody>
      </table>
    </div>
  </div>

  }
</div>
